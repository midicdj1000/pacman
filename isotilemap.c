
#include <stdio.h>
#include <conio.h>
#include <c64.h>
#include <cbm_petscii_charmap.h>
#include <peekpoke.h>

#define poke(A,X) (*(unsigned char *)A) = (X)
#define peek(A) (*(unsigned char *)A)



unsigned long count=0;
unsigned int base=8192;

unsigned char tile1[576] ={
0,0,0,0,2,10,42,170,2,10,42,170,170,170,170,170,128,160,168,170,170,170,170,170,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,170,170,170,170,170,42,10,2,170,170,170,170,170,168,160,128,170,168,160,128,0,0,0,0,
0,0,0,0,2,10,17,145,2,10,42,170,170,170,170,170,128,160,168,170,170,170,170,170,0,0,0,0,128,160,168,170,
145,17,10,2,0,0,0,0,170,170,170,170,170,42,10,2,170,170,170,170,170,168,160,128,170,168,160,128,0,0,0,0,
0,0,0,0,2,10,42,170,2,9,36,169,170,170,170,170,128,96,24,106,170,170,170,170,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,170,170,170,170,170,42,10,2,170,170,170,170,170,168,160,128,170,168,160,128,0,0,0,0,
0,0,0,0,2,10,42,170,2,10,42,170,170,170,170,170,128,160,168,170,170,170,170,170,0,0,0,0,128,160,152,70,
170,42,10,2,0,0,0,0,170,170,170,170,170,42,10,2,170,170,170,170,170,168,160,128,70,152,160,128,0,0,0,0,
0,0,0,0,2,10,42,170,2,10,42,170,170,170,170,170,128,160,168,170,170,170,170,170,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,170,170,170,170,169,36,9,2,170,170,170,170,106,24,96,128,170,168,160,128,0,0,0,0,
0,0,0,0,2,10,42,170,2,10,42,170,106,154,166,169,128,160,168,170,169,166,154,106,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,169,166,154,106,170,42,10,2,106,154,166,169,170,168,160,128,170,168,160,128,0,0,0,0,  

  0,0,0,0,2,10,42,170,2,10,42,170,106,154,166,169,128,160,168,170,170,170,170,170,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,170,170,170,170,170,42,10,2,106,154,166,169,170,168,160,128,170,168,160,128,0,0,0,0,

  0,0,0,0,2,10,42,170,2,10,42,170,170,170,170,170,128,160,168,170,169,166,154,106,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,169,166,154,106,170,42,10,2,170,170,170,170,170,168,160,128,170,168,160,128,0,0,0,0,

0,0,0,0,2,10,42,170,2,10,42,170,106,154,166,169,128,160,168,170,170,170,170,170,0,0,0,0,128,160,168,170,
170,42,10,2,0,0,0,0,169,166,154,106,170,42,10,2,170,170,170,170,170,168,160,128,170,168,160,128,0,0,0,0,  
};
 

unsigned char map[9][9]= {
  {2,1,1,1,1,1,1,1,3},
  {1,1,1,1,1,1,1,1,1},
  {1,1,1,1,1,1,1,1,1},
  {1,1,1,6,6,6,1,1,1},
  {1,1,1,6,6,6,1,1,1},
  {1,1,1,6,6,6,1,1,1},
  {1,1,1,1,1,9,1,1,1},
  {1,1,1,1,1,1,1,1,1},
  {5,1,1,1,1,1,1,1,4}
};
unsigned char isox[9][9]={
  {1,2,3,4,5,6,7,8,9},
  {2,3,4,5,6,7,8,9,10},
  {3,4,5,6,7,8,9,10,11},
  {4,5,6,7,8,9,10,11,12},
  {5,6,7,8,9,10,11,12,13},
  {6,7,8,9,10,11,12,13,14},
  {7,8,9,10,11,12,13,14,15},
  {8,9,10,11,12,13,14,15,16},
  {9,10,11,12,13,14,15,16,17}
};
unsigned char isoy[9][9]={
  {9,8,7,6,5,4,3,2,1},
  {10,9,8,7,6,5,4,3,2},
  {11,10,9,8,7,6,5,4,3},
  {12,11,10,9,8,7,6,5,4},
  {13,12,11,10,9,8,7,6,5},
  {14,13,12,11,10,9,8,7,6},
  {15,14,13,12,11,10,9,8,7},
  {16,15,14,13,12,11,10,9,8},
  {17,16,15,14,13,12,11,10,9}
};

  




void placetile(int x,int y, int tile){
  long pos=0;
  short counter=0;
  int ttile=0;
  y=y*320;
x=x*16;
  //pos+=(320*y);
for (counter=0;counter<32;counter++){
    pos=8192+counter+x+y;
  //if(PEEK(pos)==0){
  ttile=(tile-1)*64;
  	POKE(pos,PEEK(pos)|tile1[ttile+counter]);
  //} else {
  //  POKE(pos,170);
  //}  
  //if(PEEK(pos+320)==0){   
  	POKE(pos+320,PEEK(pos+320)|tile1[ttile+counter+32]);  
  //} else {
  //  POKE(pos+320,170);
 // }
  
}  
}  


void main(void) {
  
int x=0;
int y=1;
  clrscr();
	poke(53265L,peek(53265L)|32);// set memory address
  	poke(53272L,peek(53272L)|8);// set bitmap mode	
	poke(53270L,peek(53270L)|16);// set multi colour
  	poke(53281L,0); // background black
  	//poke(53282L,0); // background #1
  	//poke(53283L,0); // background #2

    	 for(count=8192;count<16192;count++){
            POKE(count,0);
           }
  for (count=0;count<1000;count++){
                POKE(count+1024,117); // 1100 =12 1110 =14
    		POKE(count+55296L,12);
  	} 
  for(x=0;x<9;x++){
    for(y=0;y<9;y++){
      placetile(isox[y][x],isoy[y][x],map[y][x]);
      }
     } 

  /*placetile(8,1,3);
  
  placetile(7,2,1);
  placetile(9,2,1);  
  
  placetile(6,3,1);  
  placetile(8,3,1);
  placetile(10,3,1);  
  
  placetile(5,4,1);
  placetile(7,4,1);
  placetile(9,4,1);
  placetile(11,4,1);
  
  placetile(4,5,1);  
  placetile(6,5,1);  
  placetile(8,5,1);
  placetile(10,5,1);  
  placetile(12,5,1);  
  
  placetile(3,6,1);
  placetile(5,6,1);
  placetile(7,6,1);
  placetile(9,6,1);
  placetile(11,6,1); 
  placetile(13,6,1);
  
  placetile(2,7,1);
  placetile(4,7,1);  
  placetile(6,7,7);  
  placetile(8,7,1);
  placetile(10,7,1);  
  placetile(12,7,1);
  placetile(14,7,1);  
  
  placetile(1,8,1); // left mid 
  placetile(3,8,1);
  placetile(5,8,1);
  placetile(7,8,7); // middle
  placetile(9,8,8);
  placetile(11,8,1); 
  placetile(13,8,1);
  placetile(15,8,1);// right mid
  
  placetile(0,9,2); 
  placetile(2,9,1); 
  placetile(4,9,1);  
  placetile(6,9,1);  
  placetile(8,9,6);
  placetile(10,9,1);  
  placetile(12,9,1);
  placetile(14,9,1);
  placetile(16,9,4);// right mid 
  
  placetile(1,10,1); 
  placetile(3,10,1);
  placetile(5,10,1);
  placetile(7,10,1);
  placetile(9,10,1); 
  placetile(11,10,1); 
  placetile(13,10,1); 
  placetile(15,10,1);  
    
  placetile(2,11,1);  
  placetile(4,11,1);  
  placetile(6,11,1);  
  placetile(8,11,1);
  placetile(10,11,1);  
  placetile(12,11,1); 
  placetile(14,11,1);  
  
  placetile(3,12,1);  
  placetile(5,12,1);
  placetile(7,12,1);
  placetile(9,12,1);
  placetile(11,12,1); 
  placetile(13,12,1); 
  
  placetile(4,13,1);  
  placetile(6,13,1);  
  placetile(8,13,1);
  placetile(10,13,1); 
  placetile(12,13,1);  
  
  placetile(5,14,1);  
  placetile(7,14,1);
  placetile(9,14,1);
  placetile(11,14,1);  
  
  placetile(6,15,1);
  placetile(8,15,1);
   placetile(10,15,1);
  
   placetile(7,16,1); 
   placetile(9,16,1);
  
   placetile(8,17,5); */
  

  
  
}
